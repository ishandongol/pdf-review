import{c as C,r as n,a as S,u as c,w as F,x as L,j as e,F as N}from"./index-CEm0uM7z.js";import{w as R}from"./withAuthenticatedLayout-CfdIN_Se.js";import{B as b}from"./BaseLayout-YoQwgQdL.js";import{P,g as _,h as v,i as w,S as B,u as A}from"./PdfView-BkHGRUSZ.js";import{B as p}from"./badge-dPZYMstU.js";import{C as E,a as k,b as D,e as H,f as I}from"./card-LMq989mQ.js";import"./index-B1xBldXN.js";import"./index-Bb4qSo10.js";const U=()=>{var h,f;const{student:o,reviewId:l}=V.useParams(),[x,r]=n.useState(!1),d=S(),t=c(s=>s.studentReviews.currentFileReview),g=c(s=>s.studentReviews.isLoading),a=c(s=>s.auth.user),[m,j]=n.useState("");n.useEffect(()=>{o&&l&&d(F({student_folder:o,review_id:l}))},[o,d,l]);const u=n.useCallback(async()=>{var s;if(t)try{r(!0);const y=await L({student:t.student_folder,file:t.file_name});j(((s=y.data)==null?void 0:s.signedUrl)||""),r(!1)}finally{r(!1)}},[t]);n.useEffect(()=>{u()},[u]);const i=(t==null?void 0:t.reviews)||[];return e.jsxs(b,{children:[g||x&&e.jsx(N,{}),e.jsxs(P,{children:[e.jsx(_,{children:m&&e.jsx(v,{reviews:i,url:m})}),e.jsx(w,{children:e.jsxs(B,{className:"h-[calc(theme(height.screen)-theme(spacing.10))] p-4",children:[i.length>0&&e.jsx("div",{className:"font-medium mb-2",children:e.jsxs(p,{variant:(a==null?void 0:a.id)===(t==null?void 0:t.user_id)?"destructive":"secondary",children:["By ",(a==null?void 0:a.id)===(t==null?void 0:t.user_id)?"You":(f=(h=t==null?void 0:t.email_id)==null?void 0:h.split("@"))==null?void 0:f[0]]})}),i.length===0&&e.jsx("div",{className:"font-medium mt-4 mb-2 h-72 flex items-center justify-center",children:"No Reviews"}),i.map(s=>e.jsxs(E,{className:"cursor-pointer mt-2",role:"button",onClick:()=>{A(s)},children:[e.jsx(k,{children:e.jsx(D,{className:" leading-relaxed",children:s.comment.text})}),e.jsxs(H,{children:[s.content.text?e.jsx("blockquote",{className:" font-thin line-clamp-3 my-2",children:s.content.text}):null,s.content.image?e.jsx("div",{className:" my-2",children:e.jsx("img",{src:s.content.image,alt:"Screenshot"})}):null]}),e.jsxs(I,{className:"flex items-center justify-start gap-2",children:["Page ",s.position.pageNumber," ",e.jsx(p,{variant:"secondary",children:"PDF"})]})]},s.id))]})})]})]})},V=C("/students/$student/review/$reviewId")({component:R(U,"File Review Page")});export{V as Route};
